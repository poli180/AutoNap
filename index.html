<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetFeeder Pro - 3-in-1 Automatischer Futterspender</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>🐾 PetFeeder Pro</h1>
            <p class="tagline">Die perfekte Lösung für Ihre Haustiere</p>
        </div>
    </header>

    <main class="container">
        <section class="hero">
            <div class="hero-content">
                <h2>3-in-1 Automatischer Futterspender für Katzen & Hunde</h2>
                <p class="hero-description">Automatischer Wasserspender, Doppelschüssel und Futternapf in einem - Die perfekte Lösung für kleine Hunde und Katzen!</p>
            </div>
        </section>

        <section class="product-showcase">
            <div class="product-main">
                <div class="product-image">
                    <div class="image-placeholder">
                        <span class="icon">🐱</span>
                        <p>3-in-1 Futterspender</p>
                    </div>
                </div>
                
                <div class="product-info">
                    <h3>Premium 3-in-1 Futterspender</h3>
                    <div class="price-section">
                        <span class="original-price">€29.99</span>
                        <span class="current-price">€14.99</span>
                        <span class="discount-badge">50% RABATT</span>
                    </div>
                    
                    <div class="features">
                        <h4>✨ Produktmerkmale:</h4>
                        <ul>
                            <li>✅ Automatischer Wasserspender mit Schwerkraftsystem</li>
                            <li>✅ Doppelschüssel für Futter und Wasser</li>
                            <li>✅ Große Kapazität - perfekt für mehrere Tage</li>
                            <li>✅ Leicht zu reinigen und nachzufüllen</li>
                            <li>✅ Robust und langlebig</li>
                            <li>✅ Ideal für Katzen und kleine Hunde</li>
                        </ul>
                    </div>
                    
                    <div class="shipping-info">
                        <p>🚚 <strong>Kostenloser Versand</strong> innerhalb Deutschlands</p>
                        <p>⏱️ Lieferzeit: 2-3 Wochen</p>
                    </div>
                    
                    <button class="checkout-btn" data-name="3-in-1 Katzen Futterspender" data-amount="1499" data-currency="eur">
                        🛒 Jetzt bestellen - Nur €14.99
                    </button>
                    
                    <div class="trust-badges">
                        <span class="badge">🔒 Sichere Zahlung</span>
                        <span class="badge">✓ Käuferschutz</span>
                        <span class="badge">💳 Stripe Payment</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="benefits">
            <h3>Warum unseren 3-in-1 Futterspender wählen?</h3>
            <div class="benefits-grid">
                <div class="benefit-card">
                    <span class="benefit-icon">💧</span>
                    <h4>Automatische Wasserzufuhr</h4>
                    <p>Ihr Haustier hat immer frisches Wasser verfügbar</p>
                </div>
                <div class="benefit-card">
                    <span class="benefit-icon">🍽️</span>
                    <h4>Doppelschüssel-Design</h4>
                    <p>Separate Bereiche für Futter und Wasser</p>
                </div>
                <div class="benefit-card">
                    <span class="benefit-icon">🧼</span>
                    <h4>Leicht zu reinigen</h4>
                    <p>Abnehmbare Teile für einfache Reinigung</p>
                </div>
                <div class="benefit-card">
                    <span class="benefit-icon">⏰</span>
                    <h4>Zeitersparnis</h4>
                    <p>Perfekt für vielbeschäftigte Tierbesitzer</p>
                </div>
            </div>
        </section>

        <section class="cta-section">
            <h3>Bereit, Ihrem Haustier das Beste zu bieten?</h3>
            <p>Bestellen Sie jetzt und profitieren Sie von 50% Rabatt!</p>
            <button class="checkout-btn large" data-name="3-in-1 Katzen Futterspender" data-amount="1499" data-currency="eur">
                🛒 Jetzt für nur €14.99 bestellen
            </button>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 PetFeeder Pro. Alle Rechte vorbehalten.</p>
            <p class="dropship-info">Produkt bereitgestellt durch <a href="https://de.aliexpress.com/item/1005009728243260.html" target="_blank" rel="noopener">AliExpress</a></p>
        </div>
    </footer>

    <script>
        // Stripe Publishable Key - wird von Environment Variable geladen
        // WICHTIG: Setzen Sie STRIPE_PUBLISHABLE_KEY in Netlify!
        const STRIPE_PUBLISHABLE_KEY = 'pk_live_YOUR_KEY_HERE';

        document.addEventListener('DOMContentLoaded', function() {
            console.log('PetFeeder Pro application started');

            // Get all checkout buttons
            const checkoutButtons = document.querySelectorAll('.checkout-btn');

            checkoutButtons.forEach(button => {
                button.addEventListener('click', async function() {
                    const productName = this.getAttribute('data-name');
                    const amount = parseInt(this.getAttribute('data-amount'));
                    const currency = this.getAttribute('data-currency');

                    console.log('Checkout clicked:', { productName, amount, currency });

                    // Disable button during processing
                    button.disabled = true;
                    const originalText = button.textContent;
                    button.textContent = '⏳ Wird verarbeitet...';

                    try {
                        // Call Netlify serverless function to create checkout session
                        const response = await fetch('/.netlify/functions/create-checkout', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                item: {
                                    name: productName,
                                    amount: amount,
                                    currency: currency,
                                    description: '3-in-1 Automatischer Futterspender für Katzen und Hunde'
                                }
                            })
                        });

                        const data = await response.json();

                        if (response.ok && data.url) {
                            // Redirect to Stripe Checkout
                            window.location.href = data.url;
                        } else {
                            throw new Error(data.error || 'Checkout-Sitzung konnte nicht erstellt werden');
                        }

                    } catch (error) {
                        console.error('Error:', error);
                        alert('Es gab ein Problem mit der Zahlung. Bitte versuchen Sie es erneut oder kontaktieren Sie uns.');

                        // Re-enable button
                        button.disabled = false;
                        button.textContent = originalText;
                    }
                });
            });

            console.log('PetFeeder Pro bereit!');
        });
    </script>
</body>
</html>